---
  - name: Test
    become: true
# tasks file for httpdserver
  - name: Run the equivalent of "apt-get update"
    shell: apt-get update && apt-get upgrade -y && apt-get autoremove && apt-get autoclean
  - name: Install apache2 using shell
    shell: apt-get install apache2
  - name: install apache2
    apt:  #Do you want to continue? [Y/n]
        name: apache2
        state: present
    register: status
  - name: install php
    package:
        name: php
        state: present
  - name: configure httpd
    template:
          src: my.conf
          dest: /etc/httpd/conf.d/my.conf
    when: status.rc == 0
    notify: restart httpd
  - name: copy html file
    copy: 
       src: /tmp/index.html 
       dest: "{{ my_path }}index.html"
  - name: start httpd
    service:
          name: httpd
          state: started
    when: status.rc == 0
